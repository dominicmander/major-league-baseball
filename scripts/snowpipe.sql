use schema raw_data_snowpipe;

--create game_log table
create or replace table game_log (
    date int,
    number_of_game int,
    day_of_week string,
    v_name string,
    v_league string,
    v_game_number int,
    h_name string,
    h_league string,
    h_game_number int,
    v_score int,
    h_score int,
    length_outs float,
    day_night string,
    completion string,
    forefeit string,
    protest string,
    park_id string,
    attendance float,
    length_minutes float,
    v_line_score string,
    h_line_score string,
    v_at_bats float,
    v_hits float,
    v_doubles float,
    v_triples float,
    v_homeruns float,
    v_rbi float,
    v_sacrifice_hits float,
    v_sacrifice_flies float,
    v_hit_by_pitch float,
    v_walks float,
    v_intentional_walks float,
    v_strikeouts float,
    v_stolen_bases float,
    v_caught_stealing float,
    v_grounded_into_double float,
    v_first_catcher_interference float,
    v_left_on_base float,
    v_pitchers_used float,
    v_individual_earned_runs float,
    v_team_earned_runs float,
    v_wild_pitches float,
    v_balks float,
    v_putouts float,
    v_assists float,
    v_errors float,
    v_passed_balls float,
    v_double_plays float,
    v_triple_plays float,
    h_at_bats float,
    h_hits float,
    h_doubles float,
    h_triples float,
    h_homeruns float,
    h_rbi float,
    h_sacrifice_hits float,
    h_sacrifice_flies float,
    h_hit_by_pitch float,
    h_walks float,
    h_intentional_walks float,
    h_strikeouts float,
    h_stolen_bases float,
    h_caught_stealing float,
    h_grounded_into_double float,
    h_first_catcher_interference float,
    h_left_on_base float,
    h_pitchers_used float,
    h_individual_earned_runs float,
    h_team_earned_runs float,
    h_wild_pitches float,
    h_balks float,
    h_putouts float,
    h_assists float,
    h_errors float,
    h_passed_balls float,
    h_double_plays float,
    h_triple_plays float,
    hp_umpire_id string,
    hp_umpire_name string,
    fb_umpire_id string,
    fb_umpire_name string,
    sb_umpire_id string,
    sb_umpire_name string,
    tb_umpire_id string,
    tb_umpire_name string,
    lf_umpire_id string,
    lf_umpire_name string,
    rf_umpire_id string,
    rf_umpire_name string,
    v_manager_id string,
    v_manager_name string,
    h_manager_id string,
    h_manager_name string,
    winning_pitcher_id string,
    winning_pitcher_name string,
    losing_pitcher_id string,
    losing_pitcher_name string,
    saving_pitcher_id string,
    saving_pitcher_name string,
    winning_rbi_batter_id string,
    winning_rbi_batter_id_name string,
    v_starting_pitcher_id string,
    v_starting_pitcher_name string,
    h_starting_pitcher_id string,
    h_starting_pitcher_name string,
    v_player_1_id string,
    v_player_1_name string,
    v_player_1_def_pos float,
    v_player_2_id string,
    v_player_2_name string,
    v_player_2_def_pos float,
    v_player_3_id string,
    v_player_3_name string,
    v_player_3_def_pos float,
    v_player_4_id string,
    v_player_4_name string,
    v_player_4_def_pos float,
    v_player_5_id string,
    v_player_5_name string,
    v_player_5_def_pos float,
    v_player_6_id string,
    v_player_6_name string,
    v_player_6_def_pos float,
    v_player_7_id string,
    v_player_7_name string,
    v_player_7_def_pos float,
    v_player_8_id string,
    v_player_8_name string,
    v_player_8_def_pos float,
    v_player_9_id string,
    v_player_9_name string,
    v_player_9_def_pos float,
    h_player_1_id string,
    h_player_1_name string,
    h_player_1_def_pos float,
    h_player_2_id string,
    h_player_2_name string,
    h_player_2_def_pos float,
    h_player_3_id string,
    h_player_3_name string,
    h_player_3_def_pos float,
    h_player_4_id string,
    h_player_4_name string,
    h_player_4_def_pos float,
    h_player_5_id string,
    h_player_5_name string,
    h_player_5_def_pos float,
    h_player_6_id string,
    h_player_6_name string,
    h_player_6_def_pos float,
    h_player_7_id string,
    h_player_7_name string,
    h_player_7_def_pos float,
    h_player_8_id string,
    h_player_8_name string,
    h_player_8_def_pos float,
    h_player_9_id string,
    h_player_9_name string,
    h_player_9_def_pos float,
    additional_info string,
    acquisition_info string
);

--create snowpipe
create or replace pipe game_log_pipe as
    copy into mlb.raw_data_snowpipe.game_log
    from '@mlb.raw_data_snowpipe.mlb_snowpipe'
;
